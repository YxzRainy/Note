---
title: Vue 数据代理
date: 2022-05-14 6:00:00
updated: 2022-05-14 6:00:00
categories:
        - 前端框架
tags:
        - Vue
        - 前端
        - Vue 2
        - 学习笔记
---

# 数据代理

通过一个对象代理对另一个对象中的属性的操作（读/写）.

```js
// 通过 obj2 访问或修改 obj1 中的 x

var obj = { x: 100 };
var obj2 = { y: 200 };

// 给 obj2 定义一个新的属性 x
Object.defineProperty(obj2, 'x', {
	get() {
		// 当访问 obj2.x 时，返回 100，并将 100 赋给 obj2.x，
		return obj.x;
	},

	// 当 obj2.x 被修改，该方法会调用，value 是修改后的新值
	set(value) {
		// 将新值赋给 obj.x
		// 这一步完成后，相当于实现了一个数据代理：
		// 通过一个 obj2 代理对另一个 obj 的属性 x 的操作（读/写）
		obj.x = value;
	},
});

// 100
console.log(obj.x);

// 100
console.log(obj2.x);

// 通过修改 obj2.x 的值，来代理修改 obj.x，这就是数据代理
obj2.x = 999;

// 999
console.log(obj.x);

```

## Vue 中的数据代理

**通过 vm 对象来代理 data 对象中属性的操作（读、写）**

使我们更加方便的操作 data 中的数据。

**model 中的 data：**

```js
var vm = new Vue({
	el: '#root',
	data: {
		name: '黔灵山',
		address: '贵州省',
	},
});
```

**vm 对象的 _data：**

`_data:{{ "name": "黔灵山", "address": "贵州省" }}`

### 原理

1. 通过`definProperty()` 将`data`中所有的属性添加到 vm 上。
2. 为每一个添加到 vm 上的属性，都定义一个`getter()`和`setter()`。
3. 因此，每当我们修改或访问 vm 中的属性，都会调用其属性所对应的`getter()` 和`setter()`，
4. 最后，在`getter()` 和`setter()`内部来访问或修改`data`中的属性值。

类似于下面，但不完整

```js
var data = {
	name: '黔灵山',
	address: '贵阳',
};
var _data = {};
var vm = {
	_data,
};

Object.defineProperty(_data, 'name', {
	get() {
		return data.name;
	},

	set(value) {
		data.name = value;
	},
});

Object.defineProperty(_data, 'address', {
	get() {
		return data.address;
	},

	set(value) {
		data.addres = value;
	},
});

console.log(data.name);

console.log(vm._data.name);

vm._data.name = '白宫';

console.log(data.name);

```

